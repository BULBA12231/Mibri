# Mibiri: Консольный E2E-мессенджер

**Секретный мессенджер для общения и звонков через консоль**

- **Платформы**: Windows, Linux, macOS, Android (Termux)
- **Функции**: регистрация пользователей, обмен публичными ключами, сквозное шифрование (NaCl/Curve25519), очереди сообщений для оффлайн пользователей, прослушивание входящих сообщений
- **Архитектура**: простой TCP-сервер-ретранслятор (не хранит приватные ключи) + консольный клиент

## Установка

### 1) Установите Python 3.9 или новее
- **Windows**: скачайте с [python.org](https://www.python.org/downloads/)
- **Linux/macOS**: используйте системный менеджер пакетов
- **Android**: установите Termux из F-Droid, затем выполните `pkg install python`

### 2) Установите зависимости
Откройте проект и установите необходимые библиотеки:
```bash
pip install -r requirements.txt
```

## Запуск сервера
```bash
python server.py --host 0.0.0.0 --port 5555
```

## Использование клиента

Создайте ключи и сохраните профиль пользователя в `~/.mibiri/<имя_пользователя>.json`.

### Генерация ключей
```bash
python client.py keygen --username алиса
```

### Регистрация на сервере
Публикует ваш публичный ключ на сервере:
```bash
python client.py register --server 127.0.0.1:5555 --username алиса
```

### Отправка сообщения
```bash
python client.py send --server 127.0.0.1:5555 \
  --from алиса --to боб --message "Привет, Боб!"
```

### Получение входящих сообщений (однократно)
```bash
python client.py inbox --server 127.0.0.1:5555 --username боб
```

### Прослушивание входящих сообщений (постоянно)
```bash
python client.py listen --server 127.0.0.1:5555 --username боб
```

## Модель безопасности
- **Приватные ключи** хранятся только локально у клиента
- **Сервер** хранит только публичные ключи и зашифрованные сообщения для оффлайн пользователей
- **Шифрование**: PyNaCl (Box, Curve25519, X25519 + XSalsa20-Poly1305)

## Важные замечания
- Это минимальная версия (MVP). Для продакшена добавьте проверку устройств, смену ключей, защиту метаданных
- Для голосовых звонков смотрите `voice_stub.py` — там заготовка для шифрованного RTP/UDP. Полная реализация аудио требует дополнительных библиотек (sounddevice/pyAudio + opus/pyAV)

## Установка на Android (Termux)
```bash
pkg install python
pip install -r requirements.txt
python server.py --host 0.0.0.0 --port 5555
```

## Лицензия
MIT
